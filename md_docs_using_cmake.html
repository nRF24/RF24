<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Optimized high speed nRF24L01+ driver class documentation: Using CMake</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Optimized high speed nRF24L01+ driver class documentation<span id="projectnumber">&#160;v1.4.6</span>
   </div>
   <div id="projectbrief">TMRh20 2020 - Optimized fork of the nRF24L01+ driver</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Using CMake </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md76">Installing the library</a><ul><li class="level2"><a href="#autotoc_md77">Automatic Installation</a></li>
<li class="level2"><a href="#autotoc_md78">Building from source code</a></li>
<li class="level2"><a href="#autotoc_md79">Using a package manager</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md80">Cross-compiling the library</a><ul><li class="level2"><a href="#autotoc_md81">Installing the library remotely</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p>A more modern approach instead of using hand-crafted <em>Makefiles</em> &amp; <em>configure</em> scripts to build &amp; install software. Please note that these instructions are not needed if you have already installed the library using <a href="md_docs_linux_install.html">these older instructions</a></p>
<h1><a class="anchor" id="autotoc_md76"></a>
Installing the library</h1>
<p>You can install the library in a few different ways.</p>
<ul>
<li>Building and installing the library from source code is preferable since it will include all the latest changes.</li>
<li>Installing the library (via a package manager) from a pre-built package is mostly for cross-compiling purposes, but it can be useful for environments that don't have all the build-time dependencies (namely CMake).</li>
</ul>
<dl class="section warning"><dt>Warning</dt><dd>If you have previously installed the library from source code using the <a href="md_docs_linux_install.html">the older instructions</a>, then you will need to uninstall it manually to avoid runtime conflicts. <div class="fragment"><div class="line">sudo rm /usr/local/lib/librf24.*</div>
<div class="line">sudo rm /usr/local/lib/librf24-bcm.so</div>
<div class="line">sudo rm -r /usr/local/include/RF24</div>
</div><!-- fragment --></dd></dl>
<p>The <em>librf24-bcm.so</em> file may not exist if you used CMake to install the library.</p>
<dl class="section note"><dt>Note</dt><dd>Since wiringPi is no longer maintained or distributed (as of RPi OS 11 bullseye), pigpio is now required for using the radio's IRQ pin. This applies to RPi, SPIDEV, and pigpio drivers. The MRAA driver may provide its own IRQ implementation. Remember that the RPi OS lite variant does not ship with pigpio installed.</dd></dl>
<h2><a class="anchor" id="autotoc_md77"></a>
Automatic Installation</h2>
<p>There is a newer automatic install script that makes use of the CMake approach.</p>
<ol type="1">
<li>Download the install.sh file from <a href="https://github.com/nRF24/.github/blob/main/installer/install.sh">https://github.com/nRF24/.github/blob/main/installer/install.sh</a> <div class="fragment"><div class="line">wget https://raw.githubusercontent.com/nRF24/.github/main/installer/install.sh</div>
</div><!-- fragment --></li>
<li>Make it executable <div class="fragment"><div class="line">chmod +x install.sh</div>
</div><!-- fragment --></li>
<li><p class="startli">Run it and choose your options </p><div class="fragment"><div class="line">./install.sh</div>
</div><!-- fragment --><p> The script will detect needed dependencies and install what it needs according to the user input.</p>
<p class="startli">It will also ask to install a python package named <a href="https://github.com/nRF24/pyRF24">pyRF24</a>. This is not the same as the traditionally provided python wrappers as the pyRF24 package can be used independent of the C++ installed libraries. For more information on this newer python package, please check out <a href="https://nrf24.github.io/pyRF24/">the pyRF24 documentation</a>.</p>
</li>
<li><p class="startli">Try an example from one of the libraries </p><div class="fragment"><div class="line">cd ~/rf24libs/RF24/examples_linux</div>
</div><!-- fragment --><p class="startli">Edit the gettingstarted example, to set your pin configuration </p><div class="fragment"><div class="line">nano gettingstarted.cpp</div>
</div><!-- fragment --><p class="startli">Build the examples. Remember to set the <code>RF24_DRIVER</code> option according to the one that was selected during the scripted install. </p><div class="fragment"><div class="line">mkdir build &amp;&amp; cd build</div>
<div class="line">cmake .. -D RF24_DRIVER=SPIDEV</div>
<div class="line">make</div>
</div><!-- fragment --><p class="startli">Run the example </p><div class="fragment"><div class="line">sudo ./gettingstarted</div>
</div><!-- fragment --></li>
</ol>
<h2><a class="anchor" id="autotoc_md78"></a>
Building from source code</h2>
<ol type="1">
<li><p class="startli">Install prerequisites if there are any (pigpio, wiringPi, MRAA, LittleWire libraries, setup SPI device etc)</p>
<p class="startli">CMake may need to be installed </p><div class="fragment"><div class="line">sudo apt-get install cmake</div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>See the <a href="http://iotdk.intel.com/docs/master/mraa/index.html">MRAA documentation</a> for more information on installing MRAA</dd></dl>
</li>
<li>Make a directory to contain the <a class="el" href="classRF24.html" title="Driver class for nRF24L01(+) 2.4GHz Wireless Transceiver.">RF24</a> library and possibly other RF24* libraries and enter it <div class="fragment"><div class="line">mkdir ~/rf24libs</div>
<div class="line">cd ~/rf24libs</div>
</div><!-- fragment --></li>
<li>Clone the <a href="https://github.com/nRF24/RF24">RF24 repo</a> and navigate to it <div class="fragment"><div class="line">git clone https://github.com/nRF24/RF24.git RF24</div>
<div class="line">cd RF24</div>
</div><!-- fragment --></li>
<li>Create a build directory inside the <a class="el" href="classRF24.html" title="Driver class for nRF24L01(+) 2.4GHz Wireless Transceiver.">RF24</a> directory and navigate to it. <div class="fragment"><div class="line">mkdir build</div>
<div class="line">cd build</div>
</div><!-- fragment --></li>
<li><p class="startli">Configure build environment</p>
<dl class="section note"><dt>Note</dt><dd>When using these instructions to install RF24Mesh, RF24Network, or RF24Gateway, the following <code>RF24_DRIVER</code> option is only needed for the <a class="el" href="classRF24.html" title="Driver class for nRF24L01(+) 2.4GHz Wireless Transceiver.">RF24</a> library and examples as well as the examples for RF24Network, RF24Mesh, and RF24Gateway. The <code>RF24_DRIVER</code> option is not needed when installing the libraries for RF24Network, RF24Mesh, and RF24Gateway.</dd></dl>
<p>Instead of specifying the <code>RF24_DRIVER</code> option in the CLI, it is recommended to use a environment variable named <code>RF24_DRIVER</code>.</p>
<div class="fragment"><div class="line">export RF24_DRIVER=SPIDEV</div>
</div><!-- fragment --><p class="startli">These instructions assume you have not set an environment variable.</p>
<div class="fragment"><div class="line">cmake .. -D RF24_DRIVER=SPIDEV</div>
</div><!-- fragment --><p> Instead of using <code>SPIDEV</code> driver (recommended), you can also specify the <code>RPi</code>, <code>wiringPi</code>, <code>MRAA</code>, or <code>LittleWire</code> as alternative drivers.</p>
<p class="startli">If the <code>RF24_DRIVER</code> option is not specified (and it is not set as an environment variable), then it will be automatically configured based on the detected CPU or installed libraries (which defaults to <code>SPIDEV</code> when auto-detection fails).</p>
</li>
<li>Build and install the library <div class="fragment"><div class="line">make</div>
<div class="line">sudo make install</div>
</div><!-- fragment --></li>
<li><p class="startli">Build the examples</p>
<p class="startli">Navigate to the <em>examples_linux</em> directory </p><div class="fragment"><div class="line">cd ../examples_linux</div>
</div><!-- fragment --><p> Make sure the pins used in the examples match the pins you used to connect the radio module </p><div class="fragment"><div class="line">nano gettingstarted.cpp</div>
</div><!-- fragment --><p> and edit the pin numbers as directed in the <a href="md_docs_rpi_general.html">linux/RPi general documation</a>. Create a build directory in the examples_linux directory and navigate to it. </p><div class="fragment"><div class="line">mkdir build</div>
<div class="line">cd build</div>
</div><!-- fragment --><p> Now you are ready to build the examples. </p><div class="fragment"><div class="line">cmake ..</div>
<div class="line">make</div>
</div><!-- fragment --><p> If using the <code>MRAA</code> or <code>wiringPi</code> drivers, then you may need to specify the <code>RF24_DRIVER</code> option again. </p><div class="fragment"><div class="line">cmake .. -D RF24_DRIVER=wiringPi</div>
<div class="line">make</div>
</div><!-- fragment --><p class="startli">Remember that the <code>RF24_DRIVER</code> option is needed for the RF24Network, RF24Mesh, and RF24Gateway examples if you specified that option (via CLI or environment variable) when installing the <a class="el" href="classRF24.html" title="Driver class for nRF24L01(+) 2.4GHz Wireless Transceiver.">RF24</a> library and examples.</p>
</li>
<li>Run an example file <div class="fragment"><div class="line">sudo ./gettingstarted</div>
</div><!-- fragment --></li>
</ol>
<h2><a class="anchor" id="autotoc_md79"></a>
Using a package manager</h2>
<p>The <a class="el" href="classRF24.html" title="Driver class for nRF24L01(+) 2.4GHz Wireless Transceiver.">RF24</a> library now (as of v1.4.1) has pre-built packages (.deb or .rpm files) that can be installed on a Raspberry Pi. These packages can be found on the library's <a href="https://GitHub.com/nRF24/RF24/releases">GitHub release page</a></p>
<ol type="1">
<li><p class="startli">Download the appropriate package for your machine</p>
<p class="startli">Go to the library's <a href="https://GitHub.com/nRF24/RF24/releases">GitHub release page</a>, and look for the latest release's assets.</p>
<p class="startli">For all Raspberry Pi variants using the Raspberry Pi OS (aka Raspbian), you need the file marked for <em>armhf</em> architecture.</p>
<p class="startli">For Raspberry Pi variants using a 64-bit OS (like Ubuntu), you need the file marked for <em>arm64</em> architecture.</p>
<p class="startli">Notice that the filenames will include the name of the utility driver that the package was built with. This does not mean that the LittleWire, MRAA, or wiringPi libraries are included in the package (you will still need to install those yourself beforehand).</p>
</li>
<li><p class="startli">Install the downloaded pkg</p>
<p class="startli">If you downloaded the file directly from your target machine using the desktop environment, then you only need to double-click the package (deb or rpm) file, and the OS should do the rest.</p>
<p class="startli">If you downloaded the file remotely and want to copy it over ssh, then use the <code>scp</code> command in a terminal. </p><div class="fragment"><div class="line">scp pkg_filename.deb pi@host_name:~/Downloads</div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>You do not need to do this from within an ssh session. Also, you can use the target machine's IP address instead of its host name.</dd></dl>
<p>The <code>scp</code> command will ask you for a password belonging to the user's name on the remote machine (we used <code>pi</code> in the above example).</p>
<p class="startli">Now you can open up a ssh session and install the copied package from the terminal. </p><div class="fragment"><div class="line">ssh pi@host_name</div>
<div class="line">cd Downloads</div>
<div class="line">dpkg -i pkg_filename.deb</div>
</div><!-- fragment --></li>
</ol>
<h1><a class="anchor" id="autotoc_md80"></a>
Cross-compiling the library</h1>
<p>The <a class="el" href="classRF24.html" title="Driver class for nRF24L01(+) 2.4GHz Wireless Transceiver.">RF24</a> library comes with some pre-made toolchain files (located in the <em>RF24/cmake/toolchains</em> directory) to use in CMake. To use these toolchain files, additional command line options are needed when configuring CMake to build the library (step 5 in the above instructions to build from source).</p>
<div class="fragment"><div class="line">cmake .. -D CMAKE_TOOLCHAIN_FILE=cmake/toolchains/armhf.cmake</div>
<div class="line">make</div>
</div><!-- fragment --><p>If you plan on using the cross-compiled library with your personal cross-compiled project, then it is advised to specify the path that your project will look in when linking to the <a class="el" href="classRF24.html" title="Driver class for nRF24L01(+) 2.4GHz Wireless Transceiver.">RF24</a> library:</p>
<div class="fragment"><div class="line">cmake .. -D CMAKE_INSTALL_PREFIX=/usr/arm-linux-gnueabihf -D CMAKE_TOOLCHAIN_FILE=cmake/toolchains/armhf.cmake</div>
<div class="line">make</div>
<div class="line">sudo make install</div>
</div><!-- fragment --><p>Remember to also specify the <code>RF24_DRIVER</code> option (via CLI or environment variable) if not using the auto-configuration feature (see step 5 in the above instructions to build from source).</p>
<h2><a class="anchor" id="autotoc_md81"></a>
Installing the library remotely</h2>
<p>To install remotely, you can create an installable package file using CMake's built-in program called CPack.</p>
<div class="fragment"><div class="line">cmake .. -D CMAKE_TOOLCHAIN_FILE=cmake/toolchains/armhf.cmake</div>
<div class="line">make</div>
<div class="line">cpack</div>
</div><!-- fragment --><p>This will create a deb file and a rpm file in a new sub-directory called "pkgs" within the build directory. You can use either of these packages to install the library to your target machine (see the above instructions about using a package manager). </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jan 9 2023 11:05:51 for Optimized high speed nRF24L01+ driver class documentation by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>
