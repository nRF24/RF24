<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Optimized high speed nRF24L01+ driver class documentation: Raspberry Pi Pico SDK (for the RP2040)</title>
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Optimized high speed nRF24L01+ driver class documentation<span id="projectnumber">&#160;v1.5.0</span>
   </div>
   <div id="projectbrief">TMRh20 2020 - Optimized fork of the nRF24L01+ driver</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="topics.html"><span>Topics</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Raspberry Pi Pico SDK (for the RP2040)</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul>
  <li class="level1">
    <a href="#autotoc_md243">Prerequisite</a>
  </li>
  <li class="level1">
    <a href="#autotoc_md244">Building the RF24 examples for the Pico SDK</a>
  </li>
  <li class="level1">
    <a href="#autotoc_md245">Incorporating RF24 libs into your project</a>
  </li>
  <li class="level1">
    <a href="#autotoc_md246">Using different pins for the SPI bus</a>
    <ul>
      <li class="level2">
        <a href="#autotoc_md247">Project Source code option</a>
      </li>
      <li class="level2">
        <a href="#autotoc_md248">Build-time configuration option</a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#autotoc_md249">Using Multiple Radios</a>
  </li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="autotoc_md242"></a></p>
<p>Just to be very clear and concise: The following instructions are <b>not required to use the Arduino IDE</b> with any RP2040-based boards. These instructions pertain to using only <a href="https://github.com/raspberrypi/pico-sdk">Raspberry Pi's Pico SDK</a> for RP2040 based boards.</p>
<h1><a class="anchor" id="autotoc_md243"></a>
Prerequisite</h1>
<p>Follow Raspberry Pi's <a href="https://rptl.io/pico-get-started">"Getting Started with Pico" document</a> to setup a proper development environment on your host PC (the machine that will build your project). Notice that the setup instructions are a little different for building on a Windows PC.</p>
<p>Either set an environment variable named <code>PICO_SDK_PATH</code> that points to your local clone of the pico-sdk or put the pico-sdk next to the <a class="el" href="classRF24.html" title="Driver class for nRF24L01(+) 2.4GHz Wireless Transceiver.">RF24</a> folder or next to the folder containing your project using the <a class="el" href="classRF24.html" title="Driver class for nRF24L01(+) 2.4GHz Wireless Transceiver.">RF24</a> library: </p><pre class="fragment">path/to/github/repos/
    pico-sdk/
    RF24/
    my_rf24_project/
</pre><p>Alternatively, the <a class="el" href="classRF24.html" title="Driver class for nRF24L01(+) 2.4GHz Wireless Transceiver.">RF24</a> repository (and optionally the RF24Network and RF24Mesh repositories) can be included into your project's "lib" folder as copies or git submodules. For more detail, see the below instructions to incorporate <a class="el" href="classRF24.html" title="Driver class for nRF24L01(+) 2.4GHz Wireless Transceiver.">RF24</a> libs into your project.</p>
<h1><a class="anchor" id="autotoc_md244"></a>
Building the RF24 examples for the Pico SDK</h1>
<p>Each example imports a set of constants (<code>CE_PIN</code>, <code>CSN_PIN</code>, <code>IRQ_PIN</code>) from the examples_pico/defaultPins.h file. Default values for SPI pins (SCK, MOSI, MISO) come from the Pico SDK repository's <a href="https://github.com/raspberrypi/pico-sdk/tree/master/src/boards/include/boards">pico-sdk/src/boards/include/boards/&lt;board_name&gt;.h files</a></p>
<ol type="1">
<li>Create a "build" directory in the <a class="el" href="classRF24.html" title="Driver class for nRF24L01(+) 2.4GHz Wireless Transceiver.">RF24</a> repository's root directory and navigate to it: <div class="fragment"><div class="line">cd RF24</div>
<div class="line">mkdir build</div>
<div class="line">cd build</div>
</div><!-- fragment --></li>
<li>Configure CMake for your desired build type and specific RP2040-based board <div class="fragment"><div class="line">cmake ../examples_pico -DCMAKE_BUILD_TYPE=Release -DPICO_BOARD=pico</div>
</div><!-- fragment --> Or if building on a Windows PC: <div class="fragment"><div class="line">cmake -G &quot;NMake Makefiles&quot; ../examples_pico -DCMAKE_BUILD_TYPE=Release -DPICO_BOARD=pico</div>
</div><!-- fragment --> The supported RP2040-based boards are listed in header files in the Pico SDK repository's <a href="https://github.com/raspberrypi/pico-sdk/tree/master/src/boards/include/boards">pico-sdk/src/boards/include/boards/&lt;board_name&gt;.h files</a>. If the <code>-DPICO_BOARD</code> option is not specified, then the Pico SDK will default to building for the Raspberry Pi Pico board.</li>
<li><p class="startli">Build the examples using the CMakeLists.txt file located in the RF24/examples_pico directory. </p><div class="fragment"><div class="line">cmake --build . --config Release</div>
</div><!-- fragment --><p> Notice we specified the build type again using the <code>--config</code> option.</p>
<dl class="section note"><dt>Note</dt><dd>If you see an error stating "'PICO_DEFAULT_SPI_SCK_PIN' was not declared in this scope", then it means the board you selected with the <code>-DPICO_BOARD</code> option (in step 2) does not have a default set of SPI pins defined for it. To workaround this error, see the below instructions to use different pins for the SPI bus.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>If doing consecutive build attempts, it is strongly encouraged to delete all files in the build directory before re-attempting to build the project.</dd></dl>
</li>
</ol>
<h1><a class="anchor" id="autotoc_md245"></a>
Incorporating RF24 libs into your project</h1>
<p>In order to use the <a class="el" href="classRF24.html" title="Driver class for nRF24L01(+) 2.4GHz Wireless Transceiver.">RF24</a> libraries in your RP2040 based project:</p>
<ol type="1">
<li><p class="startli">Make a copy of the <a class="el" href="classRF24.html" title="Driver class for nRF24L01(+) 2.4GHz Wireless Transceiver.">RF24</a> library (and optionally RF24Network and RF24Mesh libraries) in a "lib" directory located in your project's root directory. </p><pre class="fragment">  path/to/my/project/
      lib/
          RF24/
          RF24Network/
          RF24Mesh/
      src/
          CMakeLists.txt
          ...
</pre><p class="startli">Alternatively you can add the RF24* repositories as <a href="https://git-scm.com/book/en/v2/Git-Tools-Submodules">git submodules</a>.</p>
</li>
<li>Include their CMakeLists.txt files from the <a class="el" href="classRF24.html" title="Driver class for nRF24L01(+) 2.4GHz Wireless Transceiver.">RF24</a> libraries in your project's top-level CMakeLists.txt file (usually located in the "src" directory). The following snippet assumes that your project's "src" directory is on the same level as the previously mentioned "lib" directory. <div class="fragment"><div class="line">include(../lib/RF24/CMakeLists.txt)</div>
<div class="line">include(../lib/RF24Network/CMakeLists.txt)</div>
<div class="line">include(../lib/RF24Mesh/CMakeLists.txt)</div>
</div><!-- fragment --></li>
<li>In the same CMakeLists.txt file from step 2, add the <a class="el" href="classRF24.html" title="Driver class for nRF24L01(+) 2.4GHz Wireless Transceiver.">RF24</a> libraries into the <code>target_link_libraries</code> configuration: <div class="fragment"><div class="line">target_link_libraries(${CMAKE_PROJECT_NAME}</div>
<div class="line">    # ... Your project&#39;s other libraries ...</div>
<div class="line">    RF24</div>
<div class="line">    RF24Network</div>
<div class="line">    RF24Mesh</div>
<div class="line">)</div>
</div><!-- fragment --> If you are using tinyUSB, this line (or similar) should already exist: <div class="fragment"><div class="line">target_include_directories(${CMAKE_PROJECT_NAME} PRIVATE ${CMAKE_CURRENT_LIST_DIR})</div>
</div><!-- fragment --></li>
<li>Finally, remember to include the necessary RF24* libraries' header files in your project's source code where applicable. <div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="RF24_8h.html">RF24.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;RF24Network.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;RF24Mesh.h&gt;</span></div>
<div class="ttc" id="aRF24_8h_html"><div class="ttname"><a href="RF24_8h.html">RF24.h</a></div></div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>Any of the project's source file(s) that includes any of RF24* libraries must be a C++ file. It is highly recommended to use the <code>.cpp</code> file extension for such project source files.</dd></dl>
</li>
</ol>
<h1><a class="anchor" id="autotoc_md246"></a>
Using different pins for the SPI bus</h1>
<p>Initially (without modification), the SPI bus uses the default pins defined in the Pico SDK repository's <a href="https://github.com/raspberrypi/pico-sdk/tree/master/src/boards/include/boards">pico-sdk/src/boards/include/boards/&lt;board_name&gt;.h files</a>. However, there may be some boards that do not define the necessary pins to use as defaults. This can be remedied using either project source code or build-time configuration.</p>
<dl class="section warning"><dt>Warning</dt><dd>There is no support for software driven SPI on RP2040 based boards at this time. If someone is so inclined to implement this using the Pico SDK's PIO (Programmable Input Output) feature, please submit an issue or pull request to the <a href="http://github.com/nRF24/RF24">RF24 repository</a>.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Before deciding what pins to use for the SPI bus, review the <a href="https://raspberrypi.github.io/pico-sdk-doxygen/group__hardware__gpio.html#details">GPIO pins' "Function Select Table" in the Pico SDK documentation</a>. There are essentially 2 SPI buses with multiple pin options for each.</dd></dl>
<h2><a class="anchor" id="autotoc_md247"></a>
Project Source code option</h2>
<p>This option is the most reliable and flexible. It involves calling <code>SPI.begin()</code> and then passing the <code>SPI</code> object to <code><a class="el" href="classRF24.html#a388fa99b0400ce0cd887f742ef53192b">RF24::begin(_SPI*)</a></code>.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="RF24_8h.html">RF24.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="classRF24.html">RF24</a> radio(7, 8); <span class="comment">// pin numbers connected to the radio&#39;s CE and CSN pins (respectively)</span></div>
<div class="line">SPI spi;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// again please review the GPIO pins&#39; &quot;Function Select Table&quot; in the Pico SDK docs</span></div>
<div class="line">    spi.begin(spi0, 2, 3, 4); <span class="comment">// spi0 or spi1 bus, SCK, TX, RX</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!radio.begin(&amp;spi)) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Radio hardware is not responding!\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">// continue with program as normal ...</span></div>
<div class="line">}</div>
<div class="ttc" id="aclassRF24_html"><div class="ttname"><a href="classRF24.html">RF24</a></div><div class="ttdoc">Driver class for nRF24L01(+) 2.4GHz Wireless Transceiver.</div><div class="ttdef"><b>Definition</b> <a href="RF24_8h_source.html#l00159">RF24.h:160</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md248"></a>
Build-time configuration option</h2>
<p>To specify the default SPI pins used at build time, you can use either:</p>
<ol type="1">
<li>declare these pins in the CMakeLists.txt file <div class="fragment"><div class="line">target_compile_definitions(${CMAKE_PROJECT_NAME}</div>
<div class="line">    PUBLIC PICO_DEFAULT_SPI=0 # can only be 0 or 1 (as in `spi0` or `spi1`)</div>
<div class="line">    PUBLIC PICO_DEFAULT_SPI_SCK_PIN=2 # depends on which SPI bus (0 or 1) is being used</div>
<div class="line">    PUBLIC PICO_DEFAULT_SPI_TX_PIN=3  # depends on which SPI bus (0 or 1) is being used</div>
<div class="line">    PUBLIC PICO_DEFAULT_SPI_RX_PIN=4  # depends on which SPI bus (0 or 1) is being used</div>
<div class="line">)</div>
</div><!-- fragment --></li>
<li>additional command line arguments <div class="fragment"><div class="line">cmake --build . --config Release -DPICO_DEFAULT_SPI=0 -DPICO_DEFAULT_SPI_SCK_PIN=2 -DPICO_DEFAULT_SPI_TX_PIN=3 -DPICO_DEFAULT_SPI_RX_PIN=4</div>
</div><!-- fragment --></li>
</ol>
<h1><a class="anchor" id="autotoc_md249"></a>
Using Multiple Radios</h1>
<p>It is possible to drive multiple nRF24L01 transceivers on a single board. To do this each radio needs dedicated digital output pins for the CE and CSN pins.</p>
<dl class="section warning"><dt>Warning</dt><dd>The RPi Pico board's 3v regulator is typically insufficient to power more than 1 radio. It is also worth mentioning that the RPi Pico board uses a switching regulator which inherently produces electrical noise (a not steady 3v signal otherwise referred to as "power instability").</dd></dl>
<p>If you want to drive each radio with a separate SPI bus, then the following example will demonstrate how to do that.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="RF24_8h.html">RF24.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Declare the pin numbers connected to the radios&#39; CE and CSN pins (respectively)</span></div>
<div class="line"><a class="code hl_class" href="classRF24.html">RF24</a> radio0(8, 5);   <span class="comment">// first radio object</span></div>
<div class="line"><a class="code hl_class" href="classRF24.html">RF24</a> radio1(14, 13); <span class="comment">// second radio object</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// By default, one SPI bus instance is created by the RF24 lib. We&#39;ll use this</span></div>
<div class="line"><span class="comment">// default instance of the `spi0` interface for our first radio, but we want a</span></div>
<div class="line"><span class="comment">// different SPI bus for the second radio.</span></div>
<div class="line"><span class="comment">// </span></div>
<div class="line"><span class="comment">// So, here we declare a second SPI bus instance:</span></div>
<div class="line">SPI my_spi; <span class="comment">// we specify the `spi1` bus interface below</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">bool</span> setupRadios()</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Initialize the first radio using the default SPI instance</span></div>
<div class="line">    <span class="keywordflow">if</span> (!radio0.begin()) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Radio0 hardware is not responding!\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">// first radio object initialized successfully</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// specify the the second SPI bus interface and corresponding GPIO pins</span></div>
<div class="line">    my_spi.begin(spi1, 10, 11, 12); <span class="comment">// spi1 bus, SCK, TX, RX</span></div>
<div class="line">    <span class="keywordflow">if</span> (!radio1.begin(&amp;my_spi)) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Radio1 hardware is not responding!\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">// second radio object initialized successfully</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">    stdio_init_all(); <span class="comment">// init necessary IO for the RP2040</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (!setupRadios()) { <span class="comment">// if either radioX.begin() failed</span></div>
<div class="line">        sleep_ms(1000); <span class="comment">// add 1 second delay for console readability</span></div>
<div class="line">        <span class="comment">// hold program in infinite attempts to initialize the radios</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// continue with program as normal ...</span></div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun May 4 2025 for Optimized high speed nRF24L01+ driver class documentation by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2
</small></address>
</div><!-- doc-content -->
</body>
</html>
